<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Checkout</title>
  <style>
    div {
      margin-bottom: 1rem;
    }
  </style>

</head>

<body>
  <h2>결제창</h2>
  <div><span id="final-price"></span>원을 결제하겠습니다.</div>
  <div>신용카드 번호를 입력하고 결제 버튼을 눌러주세요</div>
  <form>
    <input type="text" id="cardNum" placeholder="신용카드 번호">
    <button id="payment">결제</button>
  </form>
  <script>
    //결제창 finalPrice 노드 획득
    let finalPrice = document.getElementById('final-price');
    //opener 의 totalPrice 값 획득
    let openerTotalPrice = opener.document.getElementById('total-price').innerText;
    finalPrice.innerText = openerTotalPrice;

    //카드 입력란, 결제 버튼 노드 획득
    let cardNum = document.getElementById('cardNum');
    let paymentBtn = document.getElementById('payment');

    paymentBtn.addEventListener('click', (e) => {
      //결제 버튼 클릭 시 카드 신용카드 번호 유효성 검사
      let number = cardNum.value;
      let regExpCardNum = /^[0-9.-]*$/;
      console.log(number);
      e.preventDefault();
      if (number == 0 || number.trim().length == 0) {
        //카드번호 미입력 시
        alert('신용카드 번호를 입력해 주세요.')
      } else {
        if (!regExpCardNum.test(number)) {
          //유효하지 않은 카드번호 입력 시
          alert('유효한 신용카드 번호를 입력해 주세요.');
        } else {
          //유효한 카드번호 입력 시 얼럿 창에 최종 결제 금액 표시, 확인 클릭 후 새로고침
          alert(`${number} 로 ${finalPrice.innerText} 원이 결제 완료되었습니다.`);
          location.reload()
        }
      }
    })
  </script>
</body>

</html>